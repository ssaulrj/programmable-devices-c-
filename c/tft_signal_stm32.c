// TFT module connections
unsigned int TFT_DataPort at GPIOB_ODR;
sbit TFT_RST at GPIOC_ODR.B0;
sbit TFT_CS at GPIOC_ODR.B1;
sbit TFT_RS at GPIOC_ODR.B2;
sbit TFT_WR at GPIOC_ODR.B3;
sbit TFT_RD at GPIOC_ODR.B4;
// End TFT module connections
 #define PTS 252
 #define PTS2 239
void Proceso();
//

double smp[] = {-0.00788647219827313,-0.0154118338600643,-0.0221057362361548,-0.0275414459526930,-0.0313627800425079,-0.0333071480507573,-0.0332232286107479,-0.0310821120647458,
-0.0269811208734933,-0.0211399537890748,-0.0138892625142022,-0.00565223316752655,0.00307981883273113,0.0117764498043633,0.0198999903630536,0.0269384494224154,0.0324374259779464,
0.0360290611158284,0.0374562088554426,0.0365902638276846,0.0334414425999093,0.0281607536315420,0.0210333831975181,0.0124637422663876,0.00295293136380351,-0.00693014420261656,-0.0165823671482463,
-0.0254027502528245,-0.0328293645464255,-0.0383746135356078,-0.0416566706233494,-0.0424250874268087,-0.0405788955183925,-0.0361759465437137,-0.0294327422622980,-0.0207145678777824,
-0.0105163262810761,0.000564957232608652,0.0118644652662111,0.0226888136955060,0.0323578946036525,0.0402468520284901,0.0458256439586497,0.0486937342967583,0.0486076986058758,0.0454999060859249,
0.0394869376066910,0.0308669884815994,0.0201061517183937,0.00781414529304405,-0.00528930388632058,-0.0184156153881069,-0.0307537492262975,-0.0415191668131342,-0.0500024675747723,
-0.0556147576801099,-0.0579269295509454,-0.0567003242507682,-0.0519067000653225,-0.0437360165548782,-0.0325912325812898,-0.0190700710095372,-0.00393447898343398,0.0119307343621476,
0.0275679160783217,0.0420025020890812,0.0543016948966648,0.0636324640688313,0.0693153891116270,0.0708710090956296,0.0680556878293822,0.0608845325302274,0.0496395918378769,0.0348623698520933,
0.0173305828952470,-0.00197999447375478,-0.0219468503217131,-0.0413626566044695,-0.0590045257481724,-0.0737068062126255,-0.0844332916734583,-0.0903446158669986,-0.0908567409240927,
-0.0856868199039398,-0.0748833095238616,-0.0588379991711996,-0.0382785679666815,-0.0142413340463522,0.0119750366705487,0.0388730013236088,0.0648339065379732,0.0882062723652558,0.107400103464779,
0.120982250822763,0.127767619148566,0.126901064238908,0.117925155339525,0.100829578853997,0.0760788056794034,0.0446156951907195,0.00783991274526681,-0.0324386664786407,-0.0740700736330303,
-0.114655112690171,-0.151653045239782,-0.182501176673252,-0.204740675006795,-0.216142478968061,-0.214826984721063,-0.199371355139132,-0.168898769508286,-0.123144705760225,-0.0624963865629074,
0.0119972247566272,0.0986460839127112,0.195170094221999,0.298778716832937,0.406275943468552,0.514186122926092,0.618895052549005,0.716799932383398,0.804461276388943,0.878749709847750,
0.936980765725204,0.977031318026150,0.997432132414009,0.997432132414009,0.977031318026150,0.936980765725204,0.878749709847750,0.804461276388943,0.716799932383398,0.618895052549005,
0.514186122926092,0.406275943468552,0.298778716832937,0.195170094221999,0.0986460839127112,0.0119972247566272,-0.0624963865629074,-0.123144705760225,-0.168898769508286,-0.199371355139132,
-0.214826984721063,-0.216142478968061,-0.204740675006795,-0.182501176673252,-0.151653045239782,-0.114655112690171,-0.0740700736330303,-0.0324386664786407,0.00783991274526681,0.0446156951907191,
0.0760788056794037,0.100829578853997,0.117925155339525,0.126901064238908,0.127767619148566,0.120982250822763,0.107400103464779,0.0882062723652560,0.0648339065379731,0.0388730013236088,
0.0119750366705487,-0.0142413340463520,-0.0382785679666816,-0.0588379991711996,-0.0748833095238616,-0.0856868199039397,-0.0908567409240927,-0.0903446158669986,-0.0844332916734583,
-0.0737068062126257,-0.0590045257481723,-0.0413626566044695,-0.0219468503217131,-0.00197999447375506,0.0173305828952471,0.0348623698520933,0.0496395918378769,0.0608845325302276,0.0680556878293822,
0.0708710090956296,0.0693153891116270,0.0636324640688312,0.0543016948966648,0.0420025020890812,0.0275679160783219,0.0119307343621473,-0.00393447898343398,-0.0190700710095372,-0.0325912325812896,
-0.0437360165548784,-0.0519067000653225,-0.0567003242507682,-0.0579269295509454,-0.0556147576801098,-0.0500024675747723,-0.0415191668131342,-0.0307537492262976,-0.0184156153881067,
-0.00528930388632058,0.00781414529304423,0.0201061517183935,0.0308669884815994,0.0394869376066908,0.0454999060859249,0.0486076986058758,0.0486937342967584,0.0458256439586497,0.0402468520284900,
0.0323578946036526,0.0226888136955060,0.0118644652662114,0.000564957232608652,-0.0105163262810761,-0.0207145678777822,-0.0294327422622980,-0.0361759465437138,-0.0405788955183925,
-0.0424250874268087,-0.0416566706233493,-0.0383746135356078,-0.0328293645464254,-0.0254027502528247,-0.0165823671482463,-0.00693014420261642,0.00295293136380337,0.0124637422663876,
0.0210333831975183,0.0281607536315420,0.0334414425999093,0.0365902638276845,0.0374562088554426,0.0360290611158283,0.0324374259779465,0.0269384494224154,0.0198999903630535,0.0117764498043633,
0.00307981883273113,-0.00565223316752630,-0.0138892625142022,-0.0211399537890749,-0.0269811208734933,-0.0310821120647458,-0.0332232286107479,-0.0333071480507573,-0.0313627800425079,
-0.0275414459526931,-0.0221057362361548,-0.0154118338600642,-0.00788647219827324};

double sins[] = {4.89858719658941e-16,0.0998334166468283,0.198669330795061,0.295520206661341,0.389418342308651,
0.479425538604203,0.564642473395036,0.644217687237691,0.717356090899524,0.783326909627484,0.841470984807897,
0.891207360061435,0.932039085967226,0.963558185417193,0.985449729988460,0.997494986604054,0.999573603041505,
0.991664810452469,0.973847630878195,0.946300087687414,0.909297426825682,0.863209366648874,0.808496403819590,
0.745705212176719,0.675463180551150,0.598472144103956,0.515501371821464,0.427379880233830,0.334988150155904,
0.239249329213982,0.141120008059867,0.0415806624332904,-0.0583741434275797,-0.157745694143250,-0.255541102026832,
-0.350783227689620,-0.442520443294853,-0.529836140908493,-0.611857890942720,-0.687766159183974,-0.756802495307929,
-0.818277111064412,-0.871575772413588,-0.916165936749456,-0.951602073889516,-0.977530117665097,-0.993691003633465,
-0.999923257564101,-0.996164608835841,-0.982452612624332,-0.958924274663138,-0.925814682327732,-0.883454655720153,
-0.832267442223901,-0.772764487555987,-0.705540325570392,-0.631266637872321,-0.550685542597637,-0.464602179413756,
-0.373876664830236,-0.279415498198925,-0.182162504272095,-0.0830894028174959,0.0168139004843511,0.116549204850494,
0.215119988087816,0.311541363513379,0.404849920616599,0.494113351138609,0.578439764388201,0.656986598718790,0.728969040125877,
0.793667863849153,0.850436620628565,0.898708095811627,0.937999976774739,0.967919672031487,0.988168233877001,0.998543345374605,
0.998941341839772,0.989358246623382,0.969889810845086,0.940730556679772,0.902171833756293,0.854598908088280,0.798487112623490,
0.734397097874113,0.662969230082182,0.584917192891761,0.501020856457884,0.412118485241756,0.319098362349352,0.222889914100245,
0.124454423507061,0.0247754254533573,-0.0751511204618098,-0.174326781222982,-0.271760626410945,-0.366479129251929,-0.457535893775322,
-0.544021110889370,-0.625070648892884,-0.699874687593544,-0.767685809763583,-0.827826469085654,-0.879695759971670,-0.922775421612808,
-0.956635016270189,-0.980936230066492,-0.995436253306377,-0.999990206550704,-0.994552588203989,-0.979177729151317,-0.954019249902089,
-0.919328525664676,-0.875452174688428,-0.822828594968708,-0.761983583919032,-0.693525084777122,-0.618137112237033,-0.536572918000435,
-0.449647464534600,-0.358229282236827,-0.263231791365801,-0.165604175448309,-0.0663218973512002,0.0336230472211390,0.133232041419944,
0.231509825101539,0.327474439137694,0.420167036826641,0.508661464372376,0.592073514707225,0.669569762196603,0.740375889952449,
0.803784426551621,0.859161814856497,0.905954742308463,0.943695669444105,0.972007501394976,0.990607355694870,0.999309388747918,
0.998026652716362,0.986771964274613,0.965657776549277,0.934895055524683,0.894791172140503,0.845746831142933,0.788252067375316,
0.722881349511976,0.650287840157117,0.571196869659987,0.486398688853798,0.396740573130612,0.303118356745702,0.206467481937796,
0.107753652299442,0.00796318378593508,-0.0919068502276821,-0.190858581374190,-0.287903316665067,-0.382071417184010,-0.472421986398468,
-0.558052271286780,-0.638106682347949,-0.711785342369125,-0.778352078534299,-0.837141778019748,-0.887567033581505,-0.929124012734369,
-0.961397491879558,-0.984065005081644,-0.996900066041596,-0.999774431073011,-0.992659380470633,-0.975626005468157,-0.948844497918124,
-0.912582449791184,-0.867202179485581,-0.813157111661487,-0.750987246771675,-0.681313765555500,-0.604832822406282,-0.522308589626731,
-0.434565622071894,-0.342480618469611,-0.246973661736620,-0.148999025814197,-0.0495356408783669,0.0504226878068144,0.149877209662954,
0.247834207982960,0.343314928819898,0.435365360372894,0.523065765157699,0.605539869719602,0.681963620068136,0.751573415352150,
0.813673737507106,0.867644100641669,0.912945250727628,0.949124553647895,0.975820517766976,0.992766405835907,0.999792900142669,
0.996829794278799,0.983906694618616,0.961152724502116,0.928795234077240,0.887157528692349,0.836655638536056,0.777794161801093,
0.711161222905981,0.637422596150238,0.557315053517658,0.471639003094194,0.381250491654940,0.287052651327726,0.189986675795437,
0.0910224161998438,-0.00885130929040614,-0.108636595424080,-0.207336420606761,-0.303964608811048,-0.397555683121437,-0.487174512460512,
-0.571925655109564,-0.650962305666249,-0.723494756044245,-0.788798285975419,-0.846220404175172,-0.895187367819682,-0.935209915194540,
-0.965888154236071,-0.986915558120649,-0.998082027979396,-0.999275992136628,-0.990485520897156,-0.971798445743863,-0.943401481754554,
-0.905578362006623,-0.858707002609929,-0.803255726693953,-0.739778585077893,-0.668909820378021,-0.591357529865123,-0.507896590390622,
-0.419360916073229,-0.326635126104722,-0.230645705927392,-0.132351750097771,-0.0327353793308448};

void main() {
   // Initialize 240x320 TFT display
   //GPIO_Config(&GPIOA_BASE, _GPIO_PINMASK_0 | _GPIO_PINMASK_1 | _GPIO_PINMASK_2 | _GPIO_PINMASK_3
   //                     | _GPIO_PINMASK_4,_GPIO_CFG_MODE_OUTPUT | _GPIO_CFG_SPEED_2MHZ | _GPIO_CFG_OTYPE_PP);
   //GPIO_Digital_Output(&GPIOA_BASE,_GPIO_PINMASK_0 | _GPIO_PINMASK_1 | _GPIO_PINMASK_2 | _GPIO_PINMASK_3 | _GPIO_PINMASK_4);
   GPIO_Config(&GPIOB_BASE, _GPIO_PINMASK_0 | _GPIO_PINMASK_1 | _GPIO_PINMASK_2 | _GPIO_PINMASK_3 | _GPIO_PINMASK_4 | _GPIO_PINMASK_5 | _GPIO_PINMASK_6| _GPIO_PINMASK_7,_GPIO_CFG_MODE_OUTPUT | _GPIO_CFG_SPEED_2MHZ | _GPIO_CFG_OTYPE_PP);
   GPIO_Digital_Output(&GPIOB_BASE,_GPIO_PINMASK_0 | _GPIO_PINMASK_1 | _GPIO_PINMASK_2 | _GPIO_PINMASK_3 | _GPIO_PINMASK_4 | _GPIO_PINMASK_5 | _GPIO_PINMASK_6| _GPIO_PINMASK_7);
   TFT_Init(240, 320);
   TFT_Init_ILI9341_8bit(240, 320);
   TFT_Fill_Screen(CL_BLACK);
   while(1) //Bucle principal
       Proceso();
}
void Proceso()
{
   int i;
   TFT_Set_Font(TFT_defaultFont, CL_WHITE, FO_HORIZONTAL);
   TFT_Set_Pen(CL_WHITE, 1);
   TFT_H_Line(0, 240, 170);
   for(i=0;i<PTS-1;i++)
   {
       TFT_Dot(i,sins[i]*25+70,CL_WHITE);
       TFT_Line(i, sins[i]*25+70, i+1 ,sins[i+1]*25+70);
       
       TFT_Dot(i,-smp[i]*40+250,CL_WHITE);
       TFT_Line(i, -smp[i]*40+250, i+1 ,-smp[i+1]*40+250);

   }
   delay_ms(500);
}
