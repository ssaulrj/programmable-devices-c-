%Generar la se√±al %separara una componente 1000
fs=16000;
n= 0:1/fs:0.1;
x= sin(2*pi*500*n) + sin(2*pi*750*n) + sin(2*pi*1000*n);
X1= fftshift(fft(x,1024));
f= -(fs/2): fs/1024 : (fs/2)-(fs/1024);
firhp=[0.0154841401637762 -0.0141086459734070 -0.00786187678380364 -0.00349667725114399 -0.000529434537010905 0.00140885954106257 0.00257206517182088 0.00313950609828064 0.00323187946127460 0.00293049279017570 0.00230975729356378 0.00144177029622463 0.000409473767766715 -0.000681648665317246 -0.00171597402603496 -0.00257415683271368 -0.00314319519234525 -0.00333748624400575 -0.00310864201162574 -0.00245367147263905 -0.00142633899734616 -0.000136397497943289 0.00126304843397918 0.00259392406018348 0.00367319053214652 0.00433461947987337 0.00445435786390270 0.00397353840965038 0.00291136047274671 0.00136618997112091 -0.000491777051228549 -0.00243303695107533 -0.00419579014295825 -0.00552404994331981 -0.00620187903472424 -0.00608297251898219 -0.00511516552796835 -0.00336016619246275 -0.000997027791234643 0.00170502863577033 0.00441097773739432 0.00674495881043686 0.00835663162694276 0.00896875345558160 0.00839814216179607 0.00661559541725948 0.00375369830131597 8.60703857230413e-05 -0.00396072058597718 -0.00786727311396264 -0.0111212916372324 -0.0131522352509503 -0.0136199749507922 -0.0122330323059677 -0.00896157873714571 -0.00404769155054904 0.00208435656398128 0.00878792156600931 0.0152282257713140 0.0205076878972727 0.0237535238518281 0.0241902424240740 0.0212299398251059 0.0145647476378445 0.00423080868912885 -0.00938623860668096 -0.0255792245535625 -0.0433592295068916 -0.0615271795672307 -0.0787768724820200 -0.0938151472974901 -0.105486222070348 -0.112879234313326 0.884589391053800 -0.112879234313326 -0.105486222070348 -0.0938151472974901 -0.0787768724820200 -0.0615271795672307 -0.0433592295068916 -0.0255792245535625 -0.00938623860668096 0.00423080868912885 0.0145647476378445 0.0212299398251059 0.0241902424240740 0.0237535238518281 0.0205076878972727 0.0152282257713140 0.00878792156600931 0.00208435656398128 -0.00404769155054904 -0.00896157873714571 -0.0122330323059677 -0.0136199749507922 -0.0131522352509503 -0.0111212916372324 -0.00786727311396264 -0.00396072058597718 8.60703857230413e-05 0.00375369830131597 0.00661559541725948 0.00839814216179607 0.00896875345558160 0.00835663162694276 0.00674495881043686 0.00441097773739432 0.00170502863577033 -0.000997027791234643 -0.00336016619246275 -0.00511516552796835 -0.00608297251898219 -0.00620187903472424 -0.00552404994331981 -0.00419579014295825 -0.00243303695107533 -0.000491777051228549 0.00136618997112091 0.00291136047274671 0.00397353840965038 0.00445435786390270 0.00433461947987337 0.00367319053214652 0.00259392406018348 0.00126304843397918 -0.000136397497943289 -0.00142633899734616 -0.00245367147263905 -0.00310864201162574 -0.00333748624400575 -0.00314319519234525 -0.00257415683271368 -0.00171597402603496 -0.000681648665317246 0.000409473767766715 0.00144177029622463 0.00230975729356378 0.00293049279017570 0.00323187946127460 0.00313950609828064 0.00257206517182088 0.00140885954106257 -0.000529434537010905 -0.00349667725114399 -0.00786187678380364 -0.0141086459734070 0.0154841401637762];
a=[1];
y=conv(x,firhp);
Y1= fftshift(fft(y,1024));
nn= 0 : (1/fs) : (length(y)/fs)-(1/fs); 
%--------------------------------------------------------------------------
figure(1);
subplot(2,2,1);
plot(n,x);
xlim([0 0.01]);
xlabel('n'); ylabel('y'); title('FIR x(n)');
subplot(2,2,2);
plot(f,abs(X1));
xlabel('f'); ylabel('y'); title('FIR X(W)');
subplot(2,2,3);
plot(nn,y);
xlim([0 0.01]);
xlabel('n'); ylabel('y'); title('FIR y(n)');
subplot(2,2,4);
plot(f,abs(Y1));
xlim([-1200 1200]);
xlabel('f'); ylabel('y'); title('FIR Y(w)');
%--------------------------------------------------------------------------
iirhp=[0.0154841401637762 -0.0141086459734070 -0.00786187678380364 -0.00349667725114399 -0.000529434537010905 0.00140885954106257 0.00257206517182088 0.00313950609828064 0.00323187946127460 0.00293049279017570 0.00230975729356378 0.00144177029622463 0.000409473767766715 -0.000681648665317246 -0.00171597402603496 -0.00257415683271368 -0.00314319519234525 -0.00333748624400575 -0.00310864201162574 -0.00245367147263905 -0.00142633899734616 -0.000136397497943289 0.00126304843397918 0.00259392406018348 0.00367319053214652 0.00433461947987337 0.00445435786390270 0.00397353840965038 0.00291136047274671 0.00136618997112091 -0.000491777051228549 -0.00243303695107533 -0.00419579014295825 -0.00552404994331981 -0.00620187903472424 -0.00608297251898219 -0.00511516552796835 -0.00336016619246275 -0.000997027791234643 0.00170502863577033 0.00441097773739432 0.00674495881043686 0.00835663162694276 0.00896875345558160 0.00839814216179607 0.00661559541725948 0.00375369830131597 8.60703857230413e-05 -0.00396072058597718 -0.00786727311396264 -0.0111212916372324 -0.0131522352509503 -0.0136199749507922 -0.0122330323059677 -0.00896157873714571 -0.00404769155054904 0.00208435656398128 0.00878792156600931 0.0152282257713140 0.0205076878972727 0.0237535238518281 0.0241902424240740 0.0212299398251059 0.0145647476378445 0.00423080868912885 -0.00938623860668096 -0.0255792245535625 -0.0433592295068916 -0.0615271795672307 -0.0787768724820200 -0.0938151472974901 -0.105486222070348 -0.112879234313326 0.884589391053800 -0.112879234313326 -0.105486222070348 -0.0938151472974901 -0.0787768724820200 -0.0615271795672307 -0.0433592295068916 -0.0255792245535625 -0.00938623860668096 0.00423080868912885 0.0145647476378445 0.0212299398251059 0.0241902424240740 0.0237535238518281 0.0205076878972727 0.0152282257713140 0.00878792156600931 0.00208435656398128 -0.00404769155054904 -0.00896157873714571 -0.0122330323059677 -0.0136199749507922 -0.0131522352509503 -0.0111212916372324 -0.00786727311396264 -0.00396072058597718 8.60703857230413e-05 0.00375369830131597 0.00661559541725948 0.00839814216179607 0.00896875345558160 0.00835663162694276 0.00674495881043686 0.00441097773739432 0.00170502863577033 -0.000997027791234643 -0.00336016619246275 -0.00511516552796835 -0.00608297251898219 -0.00620187903472424 -0.00552404994331981 -0.00419579014295825 -0.00243303695107533 -0.000491777051228549 0.00136618997112091 0.00291136047274671 0.00397353840965038 0.00445435786390270 0.00433461947987337 0.00367319053214652 0.00259392406018348 0.00126304843397918 -0.000136397497943289 -0.00142633899734616 -0.00245367147263905 -0.00310864201162574 -0.00333748624400575 -0.00314319519234525 -0.00257415683271368 -0.00171597402603496 -0.000681648665317246 0.000409473767766715 0.00144177029622463 0.00230975729356378 0.00293049279017570 0.00323187946127460 0.00313950609828064 0.00257206517182088 0.00140885954106257 -0.000529434537010905 -0.00349667725114399 -0.00786187678380364 -0.0141086459734070 0.0154841401637762];
aa=[1 -9.38635045332010 40.3517961220535 -104.842870949447 182.879957105543 -224.818381006039 198.710162984607 -126.255832846679 56.5043159232520 -16.9612904195719 3.07305598147996 -0.254561972978696];
bb=[0.504541349126804 -5.41329653298023 26.5333300737790 -78.4234049431375 155.299535797654 -216.345179185808 216.345179185808 -155.299535797654 78.4234049431375 -26.5333300737790 5.41329653298023 -0.504541349126804];
yy=filter(bb,aa,x);
Y2= fftshift(fft(yy,1024));

figure(2);
subplot(2,2,1);
plot(n,x);
xlim([0 0.01]);
xlabel('n'); ylabel('y'); title('IIR x(n)');
subplot(2,2,2);
plot(f,abs(X1));
xlabel('f'); ylabel('y'); title('IIR X(W)');
subplot(2,2,3);
plot(n,yy);
xlim([0 0.01]);
xlabel('n'); ylabel('y'); title('IIR y(n)');
subplot(2,2,4);
plot(f,abs(Y2));
xlim([-1200 1200]);
xlabel('f'); ylabel('y'); title('IIR Y(w)');
